!function(e){var t,a,i,n={consts:{FULL:"full",LOCAL:"local"},models:{c:Fiverr.models.context,b:Fiverr.models.browser,user:Fiverr.models.user,notifications:{url:"",boundClearMarks:!1,bindClearMarksRetryCount:0},fiverrFavicon:{pinned:"//assetsv2.fiverrcdn.com/assets/v2_realtime/favicon-notif-f39b50f5533efdd17f2a55ec0c8d82c7.gif",main:"/favicon.ico"}},selectors:{},init:function(){if(!a.b.isMobileResponsive){i.$favicon=e('link[rel*="icon"]');var n=t.getMarkedStatuses(),r=(new Date).getTime();n&&n.expires>r&&(useNewCounter=!1),this.updateCounter(t.consts.FULL),this.bindClearMarksOnClick()}},getMarkedStatuses:function(){return ft.utl.getLS("header_data_markers")},updateFavicon:function(e){i.$favicon.prop("href",e?a.fiverrFavicon.pinned:a.fiverrFavicon.main)},anyUnseenStatus:function(e){if(Fiverr.models.ps.fiverrRealTimeEnabled&&e){var a=e.markStatuses||null,i=e.mode||t.consts.FULL;if(!a){var n=t.getMarkedStatuses();if(!n)return;a=n.markedStatuses}var r=0,o=!1,s=!1;_.forOwn(a,function(e,t){return e?!1:void r++}),o=_.size(a)!==r,s&&t.updateFavicon(o),i===t.consts.FULL&&Fiverr._syncState({pinned:!0})}},updateCounter:function(a){var i=e(".js-mark"),a=a,r=(new Date).getTime(),o={notifications:!1,inbox:!1,todos:!1},s=function(a,i,n){a.length&&i&&(e.each(i,function(e,t){t?a.filter('[data-mark="'+e+'"]').addClass("marked"):a.filter('[data-mark="'+e+'"]').removeClass("marked")}),t.anyUnseenStatus({markStatuses:i,mode:n}))};if(!document.pageScope.hidePinnedFlashes){if(a===t.consts.LOCAL){var l=t.getMarkedStatuses();l&&s(i,l.markedStatuses,a)}else e.ajax({type:"get",url:"/header_data",dataType:"text",success:function(t){try{t=e.parseJSON(t)}catch(l){return setTimeout(function(){n.updateCounter(a)},6e4)}o.notifications=t.notifications_unseen,o.inbox=t.inbox_unseen,o.notifications&&!o.inbox&&(o.inbox=t.notifications_unseen),s(i,o,a),ft.utl.setLS("header_data_markers",{expires:r+6e4,markedStatuses:o})}});n.bindClearMarksOnClick()}},bindClearMarksOnClick:function(){var i=e(".js-mark").filter(function(){return-1===["notifications","inbox"].indexOf(e(this).data("mark"))}).find("> a"),r=t.getMarkedStatuses(),o=r?r.markedStatuses:!1;a.notifications.boundClearMarks||(o?(a.notifications.boundClearMarks=!0,i.on("click",function(a){a.preventDefault();var i=e(this),n=i.attr("href"),r=i.closest(".js-mark"),s=r.data("mark"),l=((new Date).getTime(),t.getMarkedStatuses());l&&(o=l.markedStatuses),o[s]=!1,ft.utl.setLS("header_data_markers",{expires:l.expires,markedStatuses:o}),t.anyUnseenStatus({markedStatuses:o,mode:t.consts.LOCAL}),r.removeClass("marked"),_.delay(function(){document.location.href=n},100)})):a.notifications.bindClearMarksRetryCount<=5&&_.delay(function(){n.bindClearMarksOnClick(),n.models.notifications.bindClearMarksRetryCount++},300))}};t=n,a=t.models,i=t.selectors,window.fNotifications=n,Fiverr.models.user&&n.init()}(jQuery),function(){var e={admin_cancelled_buyer:{group:"fullGig"},seller_blocked_cancellation:{group:"fullGig"},seller_account_deleted_cancellation:{group:"fullGig"},blocked_seller_delivered_order:{group:"fullGig"},seller_account_deleted_delivered_order:{group:"fullGig"},blocked_or_deleted_seller_delivered_order:{group:"fullGig"},admin_cancelled_seller:{group:"fullGig"},auto_completed:{group:"fullGig"},completed_by_seller:{group:"fullGig"},buyer_accepted_proposal:{group:"fullGig"},buyer_nudge:{group:"fullGig"},buyer_nudge_new_notifier:{group:"fullGig"},order_autocomplete_first_notice:{group:"fullGig"},order_autocompleted:{group:"fullGig"},provide_requirements_reminder:{group:"fullGig"},completed:{group:"fullGig"},completed_with_positive_review:{group:"fullGig"},custom:{customContent:!0,icon:"present"},delivered:{group:"fullGig"},delivered_new_notifier:{group:"fullGig"},redelivered_new_notifier:{group:"fullGig"},upsell_offered:{group:"fullGig"},seller_review_order_requirements:{group:"fullGig"},delivery_extended_autocomplete_time_to_seller:{icon:"bell"},deny_user_notif:{gigImage:!0,icon:"times",subCat:!0},featured_promotion:{gigImage:!0,icon:"ribbon",subCat:!0},free_gig:{icon:"present"},handle_buyer_cancellation:{group:"fullGig"},handle_seller_cancellation:{group:"fullGig"},seller_fiverr_choice_order_started:{group:"fullGig"},handle_waiting_for_reqs:{group:"fullGig"},in_progress:{group:"fullGig"},in_progress_item:{group:"fullGig"},new_payment_milestone_ordered:{group:"fullGig"},in_progress_with_reqs:{group:"fullGig"},new_levels_system_notification:{icon:"ribbon"},level_up_notification:{icon:"ribbon"},level_down_notification:{icon:"ribbon"},level_trs_nominated_notification:{icon:"ribbon"},level_trs_kept_notification:{icon:"ribbon"},level_two_kept_notification:{icon:"ribbon"},try_live:{icon:"bell"},mutual_cancellation_request:{group:"fullGig"},mutual_cancellation_request_accepted:{group:"fullGig"},new_offer_notification_for_buyer:{group:"fullGig"},buyer_brief_notification_for_buyer_multi:{icon:"docs"},buyer_brief_notification_for_buyer_single:{icon:"docs"},buyer_brief_notification_for_buyer:{icon:"docs"},new_order_message:{gigImage:!0,userImage:!0,subCat:!0,textLong:!0},new_order_waiting_for_reqs_to_seller:{group:"fullGig"},new_user_notification:{icon:"docs"},order_created_mobile_notification_to_seller:{group:"fullGig"},order_resolution_no_reply_initiator:{group:"fullGig"},order_resolution_no_reply_responder:{group:"fullGig"},order_resolution_opened:{group:"fullGig"},order_resolution_opened_modify_feedback:{group:"fullGig"},order_resolution_reply_add_revisions_accepted:{group:"fullGig"},order_resolution_reply_add_revisions_declined:{group:"fullGig"},order_resolution_reply_extend_delivery_accepted:{group:"fullGig"},order_resolution_reply_extend_delivery_declined:{group:"fullGig"},order_resolution_reply_modify_feedback_accepted:{group:"fullGig"},order_resolution_reply_modify_feedback_declined:{group:"fullGig"},order_resolution_reply_modify_order_accepted:{group:"fullGig"},order_resolution_reply_modify_order_declined:{group:"fullGig"},order_resolution_reply_mutual_cancellaton_accepted:{group:"fullGig"},order_resolution_reply_mutual_cancellaton_declined:{group:"fullGig"},order_resolution_reply_personal_message_accepted:{group:"fullGig"},order_resolution_reply_personal_message_declined:{group:"fullGig"},order_resolution_reply_progress_update_submitted:{group:"fullGig"},order_resolution_withdrawn:{group:"fullGig"},order_updates:{group:"fullGig"},seller_order_complete_eligibility:{group:"fullGig"},seller_order_completed_makers_diy:{group:"fullGig"},prompt_user_change_password:{icon:"docs"},pro_seller_account_created:{icon:"docs"},welcome_back_from_ooo_mode:{icon:"suitcase"},your_seller_is_back_from_ooo_mode:{group:"fullGig"},gig_pro_toggled_on:{gigImage:!0,icon:"docs"},gig_pro_toggled_off:{gigImage:!0,icon:"docs"},redelivered:{group:"fullGig"},rejected:{group:"fullGig"},request_paused:{icon:"docs"},request_unapproved:{icon:"times"},shopping_balance_deposit:{icon:"present"},shopping_balance_deposit_pending:{icon:"present"},shopping_balance_deposit_share:{icon:"present"},soft_deny_user_notif:{gigImage:!0,icon:"pencil",subCat:!0},team_member_added:{icon:"docs"},tip_notification_for_seller:{group:"fullGig"},audio_file_deny:{gigImage:!0,icon:"pencil",subCat:!0},optional_phone_verification:{icon:"phone",customAction:!0},seller_skipped_requirements:{group:"fullGig"},available_now_time_left_reminder:{userImage:!0},byob_user_notification:{icon:"present"},profile_image_not_unique_warning:{icon:"pencil"},profile_image_not_unique_deleted:{icon:"pencil"},business_accounts_team_invitation_created:{icon:"team"},business_accounts_team_invitation_accepted_invitor:{icon:"member"},business_accounts_team_invitation_accepted_invitee:{icon:"team"},workspaces_team_invitation_created:{icon:"team"},workspaces_team_invitation_accepted:{icon:"member"},business_project_created:{icon:"team"},business_project_reactivated:{icon:"team"},business_project_archived:{icon:"team"},business_project_deleted:{icon:"team"},business_project_renamed:{icon:"team"},business_project_member_added:{icon:"member"},business_project_member_removed:{icon:"member"},business_policy_purchase_request_created:{icon:"member",userImage:!0},business_policy_purchase_request_approved:{icon:"member",userImage:!0,gigImage:!0},business_order_created:{icon:"team"},and_co_announcement:{icon:"present"},buyer_profile_reminder:{icon:"form"},external_source_notification:{dynamicIcon:!0},admin_moved_gig:{icon:"pencil"},notify_user_on_referral_registration:{icon:"present"},id_verification_passed:{icon:"bell"},id_verification_failed:{icon:"bell"},id_verification_restrict_user_multiple_attempts:{icon:"bell"},id_verification_restrict_user_verification_period_expired:{icon:"bell"},id_verification_indecisive_try_again:{icon:"bell"},id_verification_indecisive_max_tries:{icon:"bell"},id_verification_document_unrecognized:{icon:"bell"},id_verification_low_quality:{icon:"bell"},id_verification_non_id:{icon:"bell"},trigger_id_verification:{icon:"bell"},seller_order_started_acknowledgement:{group:"fullGig"},seo_restructure_announcement:{icon:"pencil"},gig_handpicked:{icon:"ribbon"},seller_delivery_reminder:{group:"fullGig"},delayed_private_review:{icon:"pencil"},hidden_buying_review_created:{group:"fullGig"},late_delivery_notification_to_seller:{group:"fullGig"},very_late_delivery_notification_to_seller:{group:"fullGig"},attachment_review_comments_submitted:{group:"fullGig"},external_attachment_review_comments_submitted:{gigImage:!0,subCat:!0},mfa_verification:{icon:"bell"},fiverr_credits_removed:{icon:"bell"},fiverr_credits_removed_no_date:{icon:"bell"},studio_invite_member:{gigImage:!0,userImage:!0},studio_member_joined:{gigImage:!0,userImage:!0},studio_member_declined:{gigImage:!0,userImage:!0},studio_gig_publishable:{gigImage:!0},studio_revoke_member:{gigImage:!0,userImage:!0},studio_order_payment_cleared:{icon:"bell",gigImage:!0},studio_member_unavailable:{gigImage:!0,userImage:!0},studio_order_started:{group:"studioOrder"},studio_order_cancelled:{group:"studioOrder"},studio_order_completed:{group:"studioOrder"},studio_order_tipped:{group:"studioOrder"},business_chat_added:{icon:"bell"},seller_complete_gig_information:{icon:"bell",gigImage:!0},tax_form_notice:{icon:"bell"},tax_form_pause_gigs_notice:{icon:"bell"},tax_form_pending_validation_notice:{icon:"bell"},tax_form_completed_notice:{icon:"bell"},tax_form_failed_notice:{icon:"bell"},tax_form_answer_reminder:{icon:"bell"},collections_created_list:{userImage:!0},collections_share_with_team:{userImage:!0},collections_deleted_list:{userImage:!0},collections_edited_name:{userImage:!0},collections_added_gig:{gigImage:!0},collections_added_seller:{userImage:!0},collections_removed_gig:{gigImage:!0},collections_removed_seller:{userImage:!0}},t={fullGig:{gigImage:!0,userImage:!0,subCat:!0},studioOrder:{gigImage:!0,studioImage:!0}},a=function(a){if(!e[a])return null;var i=_.extend({},e[a]);if(i.hasOwnProperty("group")){var n=i.group;_.extend(i,t[n]),delete i.group}return i};window.notificationConfiguration=a}(),this.Fiverr=this.Fiverr||{},this.Fiverr.Templates=this.Fiverr.Templates||{},Handlebars.registerPartial("notification-aside-basic",Handlebars.template({compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,a,i){var n;return"<aside>\n"+(null!=(n=this.invokePartial(a["notification-toggle-read"],e,{name:"notification-toggle-read",data:i,indent:"    ",helpers:t,partials:a}))?n:"")+"</aside>\n"},usePartial:!0,useData:!0})),Handlebars.registerPartial("notification-aside-with-close",Handlebars.template({1:function(e,t,a,i){var n;return'        <div class="preview-image" style="background-image:url('+this.escapeExpression(this.lambda(null!=(n=null!=e?e.images:e)?n.gig:n,e))+')"></div>\n'},compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,a,i){var n;return'<aside>\n    <nav>\n        <a href="#!" class="btn-close js-btn-close">&times;</a>\n    </nav>\n'+(null!=(n=t["if"].call(e,null!=(n=null!=e?e.images:e)?n.gig:n,{name:"if",hash:{},fn:this.program(1,i,0),inverse:this.noop,data:i}))?n:"")+"</aside>\n"},useData:!0})),Handlebars.registerPartial("notification-aside-with-image",Handlebars.template({1:function(e,t,a,i){var n;return'        <div class="preview-image" style="background-image:url('+this.escapeExpression(this.lambda(null!=(n=null!=e?e.images:e)?n.gig:n,e))+')"></div>\n'},compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,a,i){var n;return"<aside>\n"+(null!=(n=this.invokePartial(a["notification-toggle-read"],e,{name:"notification-toggle-read",data:i,indent:"    ",helpers:t,partials:a}))?n:"")+(null!=(n=t["if"].call(e,null!=(n=null!=e?e.images:e)?n.gig:n,{name:"if",hash:{},fn:this.program(1,i,0),inverse:this.noop,data:i}))?n:"")+"</aside>\n"},usePartial:!0,useData:!0})),Handlebars.registerPartial("notification-date",Handlebars.template({compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,a,i){var n,r,o=t.helperMissing;return'<time datetime="'+this.escapeExpression((r=null!=(r=t.updatedAt||(null!=e?e.updatedAt:e))?r:o,"function"==typeof r?r.call(e,{name:"updatedAt",hash:{},data:i}):r))+'">'+(null!=(n=(t.howLongAgo||e&&e.howLongAgo||o).call(e,null!=e?e.updatedAt:e,!0,{name:"howLongAgo",hash:{},data:i}))?n:"")+"</time>\n"},useData:!0})),Handlebars.registerPartial("notification-footer-basic",Handlebars.template({compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,a,i){var n;return"<footer>\n"+(null!=(n=this.invokePartial(a["notification-date"],e,{name:"notification-date",data:i,indent:"    ",helpers:t,partials:a}))?n:"")+"</footer>\n"},usePartial:!0,useData:!0})),Handlebars.registerPartial("notification-footer-with-subcat",Handlebars.template({compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,a,i){var n,r=this.lambda,o=this.escapeExpression;return"<footer>\n    "+(null!=(n=this.invokePartial(a["notification-date"],e,{name:"notification-date",data:i,helpers:t,partials:a}))?n:"")+'<span class="sub-category">'+o(r(null!=(n=null!=e?e.params:e)?n.sub_category:n,e))+'</span><span class="status hint--left" data-hint="'+(null!=(n=(t.deHyphenate||e&&e.deHyphenate||t.helperMissing).call(e,null!=(n=null!=e?e.params:e)?n.order_status:n,"-"," ",{name:"deHyphenate",hash:{},data:i}))?n:"")+'"><span class="icn-status '+o(r(null!=(n=null!=e?e.params:e)?n.order_status:n,e))+'"></span></span>\n</footer>\n'},usePartial:!0,useData:!0})),Handlebars.registerPartial("notification-icon",Handlebars.template({compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,a,i){var n;return'<figure>\n    <div class="notification-icon '+this.escapeExpression((n=null!=(n=t.iconName||(null!=e?e.iconName:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{name:"iconName",hash:{},data:i}):n))+'"></div>\n</figure>\n'},useData:!0})),Handlebars.registerPartial("notification-toggle-read",Handlebars.template({1:function(e,t,a,i){return'        <a href="#!" class="mark-unread hint--bottom" data-hint="'+this.escapeExpression((t.getI18nText||e&&e.getI18nText||t.helperMissing).call(e,"notifications.mark_as_unread",{name:"getI18nText",hash:{},data:i}))+'"></a>\n'},3:function(e,t,a,i){var n,r=t.helperMissing;return'        <a href="#!" class="mark-read hint--bottom" data-hint="'+this.escapeExpression((t.getI18nText||e&&e.getI18nText||r).call(e,"notifications.mark_as_read",{name:"getI18nText",hash:{},data:i}))+'"></a>\n'+(null!=(n=(t.ifAboveGoal||e&&e.ifAboveGoal||r).call(e,null!=e?e.unreadCount:e,1,{name:"ifAboveGoal",hash:{},fn:this.program(4,i,0),inverse:this.noop,data:i}))?n:"")},4:function(e,t,a,i){var n;return'            <span class="unread-count">'+this.escapeExpression((n=null!=(n=t.unreadCount||(null!=e?e.unreadCount:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{name:"unreadCount",hash:{},data:i}):n))+"</span>\n"},compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,a,i){var n;return"<nav>\n"+(null!=(n=t["if"].call(e,null!=e?e.isRead:e,{name:"if",hash:{},fn:this.program(1,i,0),inverse:this.program(3,i,0),data:i}))?n:"")+"</nav>\n"},useData:!0})),Handlebars.registerPartial("notification-user-image",Handlebars.template({1:function(e,t,a,i){return' class="online"'},compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,a,i){var n;return"<figure"+(null!=(n=t["if"].call(e,null!=e?e.isOnline:e,{name:"if",hash:{},fn:this.program(1,i,0),inverse:this.noop,data:i}))?n:"")+'>\n    <span class="user-pict-55">'+(null!=(n=this.lambda(null!=(n=null!=e?e.images:e)?n.user:n,e))?n:"")+"</span>\n</figure>\n"},useData:!0})),this.Fiverr.Templates["notifications/inbox-drawer-item"]=Handlebars.template({1:function(e,t,a,i){return" unread"},3:function(e,t,a,i){var n;return'<a href="'+this.escapeExpression((n=null!=(n=t.url||(null!=e?e.url:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{name:"url",hash:{},data:i}):n))+'" class="js-main-action"></a>'},5:function(e,t,a,i){return this.escapeExpression((t.getI18nText||e&&e.getI18nText||t.helperMissing).call(e,"notifications.me",{name:"getI18nText",hash:{},data:i}))+" "},compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,a,i){var n,r,o=t.helperMissing,s="function",l=this.escapeExpression;return'<li class="inbox-message drawer-item'+(null!=(n=t.unless.call(e,null!=e?e.isRead:e,{name:"unless",hash:{},fn:this.program(1,i,0),inverse:this.noop,data:i}))?n:"")+'" data-id="'+l((r=null!=(r=t.id||(null!=e?e.id:e))?r:o,typeof r===s?r.call(e,{name:"id",hash:{},data:i}):r))+'">\n    '+(null!=(n=t["if"].call(e,null!=e?e.url:e,{name:"if",hash:{},fn:this.program(3,i,0),inverse:this.noop,data:i}))?n:"")+"\n"+(null!=(n=this.invokePartial(a["notification-aside-basic"],e,{name:"notification-aside-basic",data:i,indent:"    ",helpers:t,partials:a}))?n:"")+(null!=(n=this.invokePartial(a["notification-user-image"],e,{name:"notification-user-image",data:i,indent:"    ",helpers:t,partials:a}))?n:"")+'    <div class="content">\n        <header>\n            <strong>'+l((r=null!=(r=t.username||(null!=e?e.username:e))?r:o,typeof r===s?r.call(e,{name:"username",hash:{},data:i}):r))+"</strong>\n        </header>\n        <p>"+(null!=(n=t["if"].call(e,null!=e?e.isSender:e,{name:"if",hash:{},fn:this.program(5,i,0),inverse:this.noop,data:i}))?n:"")+l((r=null!=(r=t.snippet||(null!=e?e.snippet:e))?r:o,typeof r===s?r.call(e,{name:"snippet",hash:{},data:i}):r))+"</p>\n"+(null!=(n=this.invokePartial(a["notification-footer-basic"],e,{name:"notification-footer-basic",data:i,indent:"        ",helpers:t,partials:a}))?n:"")+"    </div>\n</li>\n"},usePartial:!0,useData:!0}),this.Fiverr.Templates["notifications/live-tray-inbox-item"]=Handlebars.template({1:function(e,t,a,i){return" gig-image"},3:function(e,t,a,i){var n;return'<a href="'+this.escapeExpression((n=null!=(n=t.url||(null!=e?e.url:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{name:"url",hash:{},data:i}):n))+'" class="js-main-action"></a>'},compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,a,i){var n,r,o=t.helperMissing,s="function",l=this.escapeExpression;return'<li class="inbox-message drawer-item unread'+(null!=(n=t["if"].call(e,null!=(n=null!=e?e.images:e)?n.gig:n,{name:"if",hash:{},fn:this.program(1,i,0),inverse:this.noop,data:i}))?n:"")+'" data-id="'+l((r=null!=(r=t.id||(null!=e?e.id:e))?r:o,typeof r===s?r.call(e,{name:"id",hash:{},data:i}):r))+'">\n    '+(null!=(n=t["if"].call(e,null!=e?e.url:e,{name:"if",hash:{},fn:this.program(3,i,0),inverse:this.noop,data:i}))?n:"")+"\n"+(null!=(n=this.invokePartial(a["notification-aside-with-close"],e,{name:"notification-aside-with-close",data:i,indent:"    ",helpers:t,partials:a}))?n:"")+(null!=(n=this.invokePartial(a["notification-user-image"],e,{name:"notification-user-image",data:i,indent:"    ",helpers:t,partials:a}))?n:"")+'    <div class="content">\n        <header>\n            <strong>'+l((r=null!=(r=t.username||(null!=e?e.username:e))?r:o,typeof r===s?r.call(e,{name:"username",hash:{},data:i}):r))+"</strong>\n        </header>\n        <p>"+l((r=null!=(r=t.snippet||(null!=e?e.snippet:e))?r:o,typeof r===s?r.call(e,{name:"snippet",hash:{},data:i}):r))+"</p>\n    </div>\n</li>\n"},usePartial:!0,useData:!0}),this.Fiverr.Templates["notifications/live-tray-notifications-item"]=Handlebars.template({1:function(e,t,a,i){return" gig-image"},3:function(e,t,a,i){var n;return'<a href="'+this.escapeExpression((n=null!=(n=t.url||(null!=e?e.url:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{name:"url",hash:{},data:i}):n))+'" class="js-main-action"></a>'},5:function(e,t,a,i){var n;return null!=(n=this.invokePartial(a["notification-user-image"],e,{name:"notification-user-image",data:i,indent:"        ",helpers:t,partials:a}))?n:""},7:function(e,t,a,i){var n;return null!=(n=this.invokePartial(a["notification-icon"],e,{name:"notification-icon",data:i,indent:"        ",helpers:t,partials:a}))?n:""},9:function(e,t,a,i){var n,r=this.lambda;return'            <p class="text-long"><strong>'+(null!=(n=r(null!=(n=null!=e?e.params:e)?n.user:n,e))?n:"")+'</strong>: "'+this.escapeExpression(r(null!=(n=null!=e?e.params:e)?n.message_content:n,e))+'"</p>\n'},11:function(e,t,a,i){var n;return'            <p class="'+(null!=(n=this.lambda(null!=(n=null!=e?e.params:e)?n["class"]:n,e))?n:"")+'">'+(null!=(n=(t.hasPartial||e&&e.hasPartial||t.helperMissing).call(e,"customContent",{name:"hasPartial",hash:{},fn:this.program(12,i,0),inverse:this.program(14,i,0),data:i}))?n:"")+"</p>\n"},12:function(e,t,a,i){var n;return null!=(n=this.lambda(null!=(n=null!=e?e.params:e)?n.content:n,e))?n:""},14:function(e,t,a,i){var n,r;return null!=(r=null!=(r=t.notificationContent||(null!=e?e.notificationContent:e))?r:t.helperMissing,n="function"==typeof r?r.call(e,{name:"notificationContent",hash:{},data:i}):r)?n:""},compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,a,i){var n,r,o=t.helperMissing;return'<li class="notifications-message drawer-item unread'+(null!=(n=t["if"].call(e,null!=(n=null!=e?e.images:e)?n.gig:n,{name:"if",hash:{},fn:this.program(1,i,0),inverse:this.noop,data:i}))?n:"")+'" data-id="'+this.escapeExpression((r=null!=(r=t.id||(null!=e?e.id:e))?r:o,"function"==typeof r?r.call(e,{name:"id",hash:{},data:i}):r))+'">\n    '+(null!=(n=t["if"].call(e,null!=e?e.url:e,{name:"if",hash:{},fn:this.program(3,i,0),inverse:this.noop,data:i}))?n:"")+"\n"+(null!=(n=this.invokePartial(a["notification-aside-with-close"],e,{name:"notification-aside-with-close",data:i,indent:"    ",helpers:t,partials:a}))?n:"")+(null!=(n=(t.hasPartial||e&&e.hasPartial||o).call(e,"userImage",{name:"hasPartial",hash:{},fn:this.program(5,i,0),inverse:this.program(7,i,0),data:i}))?n:"")+'    <div class="content">\n'+(null!=(n=(t.hasPartial||e&&e.hasPartial||o).call(e,"textLong",{name:"hasPartial",hash:{},fn:this.program(9,i,0),inverse:this.program(11,i,0),data:i}))?n:"")+"    </div>\n</li>\n"},usePartial:!0,useData:!0}),this.Fiverr.Templates["notifications/notification-phone-verify"]=Handlebars.template({compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,a,i){var n;return'<div class="phone-verify-notify js-phone-verify-notify gig-image">\n    <figure>\n        <div class="notification-icon phone"></div>\n    </figure>\n    <div class="content">\n        <label>\n            '+(null!=(n=(t.getI18nText||e&&e.getI18nText||t.helperMissing).call(e,"application.titles.phone_verification.notification.title",{name:"getI18nText",hash:{},data:i}))?n:"")+"\n        </label>\n    </div>\n</div>"},useData:!0}),this.Fiverr.Templates["notifications/notifications-drawer-item"]=Handlebars.template({1:function(e,t,a,i){return" unread"},3:function(e,t,a,i){return" gig-image"},5:function(e,t,a,i){var n;return'<a href="'+this.escapeExpression((n=null!=(n=t.url||(null!=e?e.url:e))?n:t.helperMissing,"function"==typeof n?n.call(e,{name:"url",hash:{},data:i}):n))+'" class="js-main-action"></a>'},7:function(e,t,a,i){return'<a href="#!" class="js-custom-action"></a>'},9:function(e,t,a,i){var n;return null!=(n=this.invokePartial(a["notification-aside-with-image"],e,{name:"notification-aside-with-image",data:i,indent:"        ",helpers:t,partials:a}))?n:""},11:function(e,t,a,i){var n;return null!=(n=this.invokePartial(a["notification-aside-basic"],e,{name:"notification-aside-basic",data:i,indent:"        ",helpers:t,partials:a}))?n:""},13:function(e,t,a,i){var n;return null!=(n=this.invokePartial(a["notification-user-image"],e,{name:"notification-user-image",data:i,indent:"        ",helpers:t,partials:a}))?n:""},15:function(e,t,a,i){var n;return null!=(n=this.invokePartial(a["notification-icon"],e,{name:"notification-icon",data:i,indent:"        ",helpers:t,partials:a}))?n:""},17:function(e,t,a,i){var n,r=this.lambda;return'            <p class="text-long"><strong>'+(null!=(n=r(null!=(n=null!=e?e.params:e)?n.user:n,e))?n:"")+'</strong>: "'+this.escapeExpression(r(null!=(n=null!=e?e.params:e)?n.message_content:n,e))+'"</p>\n'},19:function(e,t,a,i){var n;return"            <p>"+(null!=(n=(t.hasPartial||e&&e.hasPartial||t.helperMissing).call(e,"customContent",{name:"hasPartial",hash:{},fn:this.program(20,i,0),inverse:this.program(22,i,0),data:i}))?n:"")+"</p>\n"},20:function(e,t,a,i){var n;return null!=(n=this.lambda(null!=(n=null!=e?e.params:e)?n.content:n,e))?n:""},22:function(e,t,a,i){var n,r;return null!=(r=null!=(r=t.notificationContent||(null!=e?e.notificationContent:e))?r:t.helperMissing,n="function"==typeof r?r.call(e,{name:"notificationContent",hash:{},data:i}):r)?n:""},24:function(e,t,a,i){var n;return null!=(n=this.invokePartial(a["notification-footer-with-subcat"],e,{name:"notification-footer-with-subcat",data:i,indent:"            ",helpers:t,partials:a}))?n:""},26:function(e,t,a,i){var n;return null!=(n=this.invokePartial(a["notification-footer-basic"],e,{name:"notification-footer-basic",data:i,indent:"            ",helpers:t,partials:a}))?n:""},compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,a,i){var n,r,o=t.helperMissing;return'<li class="notifications-message drawer-item'+(null!=(n=t.unless.call(e,null!=e?e.isRead:e,{name:"unless",hash:{},fn:this.program(1,i,0),inverse:this.noop,data:i}))?n:"")+(null!=(n=t["if"].call(e,null!=(n=null!=e?e.images:e)?n.gig:n,{name:"if",hash:{},fn:this.program(3,i,0),inverse:this.noop,data:i}))?n:"")+'" data-id="'+this.escapeExpression((r=null!=(r=t.id||(null!=e?e.id:e))?r:o,"function"==typeof r?r.call(e,{name:"id",hash:{},data:i}):r))+'">\n    '+(null!=(n=t["if"].call(e,null!=e?e.url:e,{name:"if",hash:{},fn:this.program(5,i,0),inverse:this.noop,data:i}))?n:"")+"\n    "+(null!=(n=(t.hasPartial||e&&e.hasPartial||o).call(e,"customAction",{name:"hasPartial",hash:{},fn:this.program(7,i,0),inverse:this.noop,data:i}))?n:"")+"\n"+(null!=(n=(t.hasPartial||e&&e.hasPartial||o).call(e,"gigImage",{name:"hasPartial",hash:{},fn:this.program(9,i,0),inverse:this.program(11,i,0),data:i}))?n:"")+(null!=(n=(t.hasPartial||e&&e.hasPartial||o).call(e,"userImage",{name:"hasPartial",hash:{},fn:this.program(13,i,0),inverse:this.program(15,i,0),data:i}))?n:"")+'    <div class="content">\n'+(null!=(n=(t.hasPartial||e&&e.hasPartial||o).call(e,"textLong",{name:"hasPartial",hash:{},fn:this.program(17,i,0),inverse:this.program(19,i,0),data:i}))?n:"")+(null!=(n=(t.hasPartial||e&&e.hasPartial||o).call(e,"subCat",{name:"hasPartial",hash:{},fn:this.program(24,i,0),inverse:this.program(26,i,0),data:i}))?n:"")+"    </div>\n</li>\n"},usePartial:!0,useData:!0}),function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports["notification-drawer"]=t():e["notification-drawer"]=t()}(this,function(){return function(e){function t(i){if(a[i])return a[i].exports;var n=a[i]={i:i,l:!1,exports:{}};return e[i].call(n.exports,n,n.exports,t),n.l=!0,n.exports}var a={};return t.m=e,t.c=a,t.i=function(e){return e},t.d=function(e,a,i){t.o(e,a)||Object.defineProperty(e,a,{configurable:!1,enumerable:!0,get:i})},t.n=function(e){var a=e&&e.__esModule?function(){return e["default"]}:function(){return e};return t.d(a,"a",a),a},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=103)}({103:function(e,t,a){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var n=a(9),r=i(n),o=a(53),s=i(o),l=a(50),u=i(l),d=a(79),c=i(d);t["default"]=function(){Handlebars.registerHelper("deHyphenate",r["default"]),Handlebars.registerHelper("iconName",s["default"]),Handlebars.registerHelper("hasPartial",u["default"]),Handlebars.registerHelper("notificationContent",c["default"])}(),e.exports=t["default"]},50:function(e,t,a){"use strict";e.exports=function(e,t){var a=t.data.root.subType,i=notificationConfiguration(a);return i.hasOwnProperty(e)?t.fn(this):t.inverse(this)}},53:function(e,t,a){"use strict";e.exports=function(e){var t=e.data.root.subType,a=notificationConfiguration(t);return a.hasOwnProperty("icon")?a.icon:a.hasOwnProperty("dynamicIcon")?e.data.root.params.icon:"docs"}},79:function(e,t,a){"use strict";e.exports=function(e){var t=e.data.root;return $.t("notifications.content."+t.subType,t.params||{})}},9:function(e,t,a){"use strict";e.exports=function(e){return e.replace(/-/g," ")}}})}),function(e){MixpanelWrapper.bindLink('.js-show-tab[data-show-tab="inbox"]',MixpanelWrapper.Events.ConversationsEvents.OPENED_INBOX_PREVIEW);var t,a,i,n,r=0===e(".js-notification-drawer").length,o=0===e(".js-hover-drawer").length,s="inbox",l="notifications",u="recent",d="loadMore",c="initial",f="pull-up",p="pull-down",m="locked",g="loading-stripe",h="drawer-item",v="nochange",b="bounce",w="new",y="refresh",k="itemList",C="itemStore",I={delay:250},x={config:{ajaxCounter:0,pageSize:10,hoverDrawerHeight:532,requestInterval:5e3,timestampPlaceHolder:":timestamp:",routes:{inbox:{markAsRead:Fiverr.models.ps.markConversationAsReadUrl,markAsUnread:Fiverr.models.ps.markConversationAsUnreadUrl,preview:Fiverr.models.ps.previewConversationDefaultTimestampUrl},notifications:{markAsRead:Fiverr.models.ps.markNotificationAsReadUrl,markAsUnread:Fiverr.models.ps.markNotificationAsUnreadUrl,preview:Fiverr.models.ps.previewNotificationDefaultTimestampUrl}}},hasRecentRequestExpired:function(e){var a=t.recentRequest(e).get("time");return!a||a&&M.isBeforeNow(a+n.requestInterval)},recentRequest:function(e){return store.drawers.getIn(e,["recentRequest"])},getItems:function(e){t.isBeforeInitialRequest(e)?t.getInitial(e):t.getRecent(e)},getRecent:function(e){t.hasRecentRequestExpired(e)&&D.getRecent(e)},handleRealTimeItem:function(e){return D.handleRealTimeItem(e)},handleSingleItem:function(e){return D.handleSingleItem(e)},isBeforeInitialRequest:function(e){var a=t.recentRequest(e);return!a.get("time")},getInitial:function(e){t.hasRecentRequestExpired(e)&&(D.getInitial(e),T.drawer.showLoading(e))},loadMore:function(e,t){D.loadMore(e,t)},toggleRead:function(e,t){var a=D.getItemContainer(e),i=a.itemStore,n=i.get(t);n=n.toggleRead()},getSubType:function(e,t){var a=D.getItemContainer(e),i=a.itemStore,n=i.get(t);return n.subType},getNotificationCount:function(e){var t=D.getItemContainer(e),a=t.itemList;return a.length},renderBunch:function(e,t,a){var i=D.getItemContainer(e),r=i.itemList,o=i.itemStore,t=t||n.pageSize,a=a||0;r=r.skip(a),r=r.take(t),r.forEach(function(e){"dummy"!==e&&T.item.addToView(o.get(e))})},localRefresh:function(e,t){var a=!0,i=D.getItemContainer(e),n=i.itemStore;n.has(t)&&T.item.addToView(n.get(t),a)},disableLoadMore:function(e){T.drawer.toggleLoadMore(e,!1),T.hoverDrawer.should(T.hoverDrawer.disableLoadMore,[e])},initialListIsEmpty:function(e,a){var i=!0;t.disableLoadMore(e),T.drawer.toggleEmptyState(e,i,a),T.hoverDrawer.should(T.hoverDrawer.turnHoverToRedirect,[e])},itemsAddedToEmptyList:function(e){var t=!1;T.drawer.toggleEmptyState(e,t)},updateTotalUnreadCount:function(e,t){T.drawer.updateTotalUnreadCount(e,t),T.notificationMarkers.toggleMarker(e,!!t)}},D={models:{ps:Fiverr.models.ps,user:Fiverr.models.user,drawers:{},store:Immutable.Map.of("drawers",Immutable.Map())},init:function(){store.set("itemTypes",Immutable.List.of(l,s)),store.get("itemTypes").forEach(function(e){var t={itemStore:{},itemList:[],recentRequest:{time:0,requestedData:null},unreadCount:0};store.set(e,Immutable.fromJS(t))})},getCorrectDataName:function(e){return e===s?"conversations":l},getItemContainer:function(e){var t=store.get(e);return{itemList:t.get(k),itemStore:t.get(C)}},updateRecentRequest:function(e,t){var a=store.drawers.getIn(e,["recentRequest"]),i={recentRequest:{}};if(t!=d){var n=Date.now();i.recentRequest.time=n}else i.recentRequest.time=a.get("time");i.recentRequest.requestedData=t,store.drawers.merge(e,i)},postUpdateRead:function(a,i,r){var o=i?n.routes[a].markAsRead:n.routes[a].markAsUnread;e.ajax({type:"post",url:o,data:{id:r}}),t.localRefresh(a,r)},incrementTotalUnreadCount:function(e,t){var a=D.getTotalUnreadCount(e);a+=t,0>a&&(a=0),D.updateTotalUnreadCount(e,a)},updateTotalUnreadCount:function(e,i){var r=e+"UnreadUpdateDelay";i=i||0,clearTimeout(a[r]),a[r]=setTimeout(function(){store.drawers.updateIn(e,["unreadCount"],i),t.updateTotalUnreadCount(e,i),2===n.ajaxCounter&&(T.hoverDrawer.openInboxDrawer("inbox"),n.ajaxCounter=0)},50)},getTotalUnreadCount:function(e){return unreadCount=store.drawers.getIn(e,["unreadCount"])},getInitial:function(e){var a=!0,i=0,r=D.addTimestampToPreviewUrl(e,i),o=D.getCorrectDataName(e);D.updateRecentRequest(e,c),D.getItemsAjax(e,r,function(i){var r=i.service_unavailable||!1;return _.isEmpty(i[o])?t.initialListIsEmpty(e,r):(t.itemsAddedToEmptyList(e),_.size(i[o])<=n.pageSize&&t.disableLoadMore(e),i[o].forEach(function(t){D.newItem(e,t,a)}),void D.itemsReady(e))})},getRecent:function(e){D.updateRecentRequest(e,u);var a,i=D.getItemContainer(e),n=i.itemList,r=i.itemStore,o=0,s=D.getCorrectDataName(e),l=!n.isEmpty();if(l&&r.has(n.get(0))){var d=n.first();o=store.item.getById(e,d).updatedAt,o=M.msToSconds(o)}a=D.addTimestampToPreviewUrl(e,o),D.getItemsAjax(e,a,function(a){_.isEmpty(a[s])||(l&&t.itemsAddedToEmptyList(e),a[s].forEach(D.handleSingleItem))})},handleRealTimeItem:function(e){var t=e.type||e.msg_type||l;return D.newItem(t,e,!1)},handleSingleItem:function(e){var a=e.type||e.msg_type||l,i=t.isBeforeInitialRequest(a);if(i){var e=D.newItem(a,e,i);return t.getItems(a),D.itemsReady(a,1),e}D.updateRecentRequest(a,u);var n=store.item.getById(a,e.id),r=D.getItemContainer(a),o=r.itemList;if(!n)return e=D.newItem(a,e,i),D.itemsReady(a,1),e;if(n.fastForward(e),n.state===b){var s=o.findIndex(function(e){return e===n.id});o=o.splice(s,1),o=o.unshift(n.id),store.drawers.updateIn(a,[k],o)}return e=store.item.getById(a,e.id),D.itemsReady(a,1),e},getItemsAjax:function(t,a,i){e.ajax({dataType:"json",type:"get",url:a,success:function(e){var a=e.unread_conversations_count||e.unread_notifications_count;n.ajaxCounter++,Fiverr._nullOrUndefined(a)&&(a=0),D.updateTotalUnreadCount(t,a),i(e)}})},addTimestampToPreviewUrl:function(e,t){return n.routes[e].preview.replace(n.timestampPlaceHolder,t)},loadMore:function(e,a){var i=D.getItemContainer(e),r=i.itemList;D.updateRecentRequest(e,d),r.has(a)?(t.renderBunch(e,n.pageSize,a),D.canLoadMore(e,a)||t.disableLoadMore(e)):t.disableLoadMore(e)},canLoadMore:function(e,t){var a=D.getItemContainer(e),i=a.itemList,r=t+n.pageSize;return i.has(r)},itemsReady:function(e,a){t.renderBunch(e,a||0)},newItem:function(e,a,i){var n=new D.item(a);if(t.isBeforeInitialRequest(n.type))return n;var r=D.getItemContainer(n.type);r.itemList,r.itemStore,n.id;return store.item.add(e,n,i),n},item:function(e){this.fastForward(e)}},T={selectors:{$body:Fiverr.selectors.$body||e("body"),$headerWrapper:Fiverr.selectors.$mainHeader||e("#main-wrapper-header")},init:function(){i.$mainHeader=Fiverr.selectors.$jsHeader,T.drawer.init(),T.hoverDrawer.init(),T.notificationMarkers.init(),Fiverr.models.ps.show_verification_grace_pf&&!Fiverr.models.browser.isMobile&&fLoader({load:["//assetsv2.fiverrcdn.com/assets/phone-verification-notification.js-69e671382fc6a861d4959be898748682.erb"],complete:function(){fPhoneVerificationNotification.bindMandatory()}})},drawer:{init:function(){i.$allNotificationDrawers=e(".js-notification-drawer"),i.notificationDrawers={},i.$allNotificationDrawers.each(function(t,a){var i=e(a),n=i.data("type"),r=T.drawer.get(n);r?(r.off(),T.drawer.set(n,r.add(i)),T.drawer.bindActions(n)):(T.drawer.set(n,i),T.drawer.bindActions(n))})},get:function(e){return i.notificationDrawers[e]},set:function(e,t){i.notificationDrawers[e]=t},bindActions:function(a){var i=T.drawer.get(a);i.on("click","nav a",function(i){i.preventDefault();var n=e(i.target).closest("."+h),r=n.data("id"),o="unread",s="item_mark_",l=n.hasClass(o);t.toggleRead(a,r),s+=l?"read":o,M.track(a,s)}),i.on("click","a.js-main-action",function(){M.track(a,"item_click")}),i.on("click","a.js-custom-action",function(i){i.preventDefault();var n=e(i.target).closest("."+h),r=n.data("id"),o=n.hasClass("unread"),s=t.getSubType(a,r);switch(o&&t.toggleRead(a,r),s){case"optional_phone_verification":fLoader({load:["//assetsv2.fiverrcdn.com/assets/phone-verification-notification.js-69e671382fc6a861d4959be898748682.erb"],complete:function(){fPhoneVerificationNotification.optional(i)}})}}),i.next(".js-load-more").on("click",function(e){e.preventDefault(),T.drawer.loadMore(a)}),i.on("attach",_.debounce(function(){T.drawer.toggleLoadMore(a,!0)},50))},updateTotalUnreadCount:function(e,t){var a=T.drawer.get(e);!r&&a&&a.length&&(a.data("totalUnreadCount",t),T.hoverDrawer.should(T.hoverDrawer.updateTotalUnreadCount,[e,t]),a.trigger("unreadCountUpdated",{type:e,count:t}))},showLoading:function(e){var t=T.drawer.get(e),a=g;!r&&t&&t.length&&(t.addClass(a),setTimeout(function(){t.removeClass(a)},1e3))},toggleLoadMore:function(e,t){if(!r){var a=T.drawer.get(e);if(a&&a.length){var i="js-load-more",n=a.next("."+i),o="removed";t?n.removeClass(o):n.hasClass(o)?n.remove():(n.removeClass(i).addClass(o),n.on("transitionend",function(){n.remove()}))}}},toggleEmptyState:function(e,t,a){var i=T.drawer.get(e);if(!r&&i&&i.length){var n=i.parent();n.toggleClass("drawer-empty",t),a&&t&&n.addClass("unavailable")}},getItems:function(e,a){t.getItems(e),T.drawer.updateAllTimestamps(e),"function"==typeof a&&a()},loadMore:function(a){var i={},n=T.drawer.get(a).find("."+h).filter(function(){var t=e(this),a=t.data("id");return i[a]?!1:(i[a]=!0,!0)}),r=n.length;t.loadMore(a,r),M.track(a,"load-more")},updateAllTimestamps:function(e){var t=T.drawer.get(e),a=t.data("recentTimeTagUpdate"),i=Date.now();(!a||M.isBeforeNow(a+6e4))&&(T.drawer.iterateItemsAndCallback(e,T.item.refreshTimeTag),t.data("recentTimeTagUpdate",i))},iterateItemsAndCallback:function(t,a){var i=T.drawer.get(t),n=i.find("."+h);n.each(function(i,n){a(t,e(n))})}},item:{find:function(e,t){var a,i=T.drawer.get(e);if(i&&i.length)return a=i.find('.drawer-item[data-id="'+t+'"]')},renderTemplate:function(t){var a=s;notificationConfiguration(t.subType)&&(a=l);var i=Fiverr._getHbTemplate({tplType:l,tplName:a+"-"+h,tplData:t});return e(i)},addToView:function(e,t){var a,i=e.type,n=e.id,r=T.drawer.get(i);(t||T.item.shouldRender(e))&&(a=T.item.renderTemplate(e),e.state===b?T.item.bounce(i,n,a):t||e.state===y?T.item.refresh(i,n,a):T.item.attach(e,a),M.view.trimLongText(r,a),r.removeClass(g).trigger("addToView"))},shouldRender:function(e){var t=e.type,a=e.id,i=e.state!==v,n=T.item.find(t,a);return i?!0:!n.length},removeDuplicates:function(e,t){var a=T.item.find(e,t);a.remove()},attach:function(e,a){var i=e.type,n=e.id,r=T.drawer.get(i),o=t.recentRequest(i).get("requestedData"),s=o&&o!==u,l=o&&o===d;if(e.state===b)T.item.removeDuplicates(i,n),r.prepend(a);else if(e.state===w)T.item.removeDuplicates(i,n),s?r.append(a):r.prepend(a);else{if(e.state!==v||!l)return;T.item.removeDuplicates(i,n),r.append(a)}r.trigger("attach")},refresh:function(e,t,a){var i=T.item.find(e,t);i.replaceWith(a)},bounce:function(e,t,a){var i;$drawer=T.drawer.get(e),i=T.item.find(e,t),i.remove(),a.css("visibility","hidden"),a.css("visibility",""),$drawer.prepend(a)},refreshTimeTag:function(e,t){var a=t.find("time"),i=parseInt(a.attr("datetime"),10),n=Fiverr.howLongAgo(i);a.text(n)}},hoverDrawer:{init:function(){var t=function(t,a,n){var r=e(a),o=n?"."+n+" ":"",s=r.find("> header"),l=s.find(o+".js-view-link"),u=s.find(o+".js-total-unread-count"),d=r.find(o+".js-notification-drawer"),c=d.closest("li"),f=c.find(".js-hover-drawer-trigger"),p=r.find(o+".antiscroll-wrap"),m=r.find(o+".antiscroll-inner"),g=n||c.data("mark");i.hoverDrawer[g]={$trigger:f,$hoverDrawer:r,$header:s,$viewLink:l,$unreadCount:u,$drawer:d,$parent:c,$scroll:p,$scrollInn:m,state:0},T.hoverDrawer.bindEvents(g),T.selectors.hoverDrawer[g].$trigger.removeAttr("disabled")};Fiverr.models.browser.isMobileResponsive||(i.hoverDrawer={},i.$mainHeader.find(".js-hover-drawer [data-tab]").each(function(a,i){var n=e(i);t(a,n.closest(".js-hover-drawer"),n.data("tab"))}))},should:function(e,t){var a=!Fiverr.models.browser.isMobileResponsive;a&&e.apply(this,t)},updateTotalUnreadCount:function(e,t){var a=i.hoverDrawer[e];if(!o&&a&&a.length){var n=a.$unreadCount,r="";t&&(r="("+t+")"),n.text(r)}},closeDrawer:function(e){var t=i.hoverDrawer[e],a=t.$hoverDrawer;a.addClass("hidden"),t.state=0,T.hoverDrawer.offEventsOnClose(e)},openDrawer:function(e){var t=i.hoverDrawer[e],a=t.$hoverDrawer;a.removeClass("hidden"),t.state=1,T.drawer.getItems(e),T.hoverDrawer.onHoverDrawerOpen(e),setTimeout(function(){T.hoverDrawer.bindFakeModal(e)},0)},openInboxDrawer:function(e){var t=store.drawers.getIn("inbox",["unreadCount"]),a=store.drawers.getIn("notifications",["unreadCount"]);0===a&&t>0&&T.hoverDrawer.showInboxDrawer()},showInboxDrawer:function(){var t=e('[data-event-type="notifications"]'),a=e('[data-event-type="inbox"]'),i=e('[data-tab="notifications"]'),n=e('[data-tab="inbox"]');t.removeClass("selected"),a.addClass("selected"),i.addClass("hidden"),n.removeClass("hidden")},toggleHideDrawer:function(e){var t=i.hoverDrawer[e];1===t.state?T.hoverDrawer.closeDrawer(e):T.hoverDrawer.openDrawer(e),t.$parent.toggleClass("open",!!t.state)},redirectToViewPage:function(e){var t=i.hoverDrawer[e],a=t.$viewLink.prop("href");a&&(window.location=a)},bindFakeModal:function(t){i.$body.on("click.fakeModal",function(a){var i=e(a.target),n=!(i.closest(".js-hover-drawer").length+i.closest("."+h).length);n&&T.hoverDrawer.closeDrawer(t)}),i.$body.on("keyup.fakeModal",function(e){27===e.keyCode&&T.hoverDrawer.closeDrawer(t)})},offEventsOnClose:function(e){i.hoverDrawer[e];i.$body.off("click.fakeModal"),i.$body.off("keyup.fakeModal"),T.hoverDrawer.destoryScrollBar(e)},bindEvents:function(t){var a=i.hoverDrawer[t],n=a.$hoverDrawer,r=a.$drawer,o=a.$scrollInn;a.$trigger.on("click",function(e){e.preventDefault(),T.hoverDrawer.toggleHideDrawer(t)}),a.$trigger.on("mouseenter",function(e){T.drawer.getItems(s),T.drawer.getItems(l)}),a.$hoverDrawer.find(".js-show-tab").on("click",function(t){t.preventDefault();var a=e(this);e(".js-show-tab").removeClass("selected"),a.addClass("selected"),e(".js-notifications-wrapper").addClass("hidden"),e(".js-notifications-wrapper."+a.data("show-tab")).removeClass("hidden"),e(".js-see-all").addClass("hidden"),e(".js-see-all."+a.data("show-tab")).removeClass("hidden")}),r.on("attach",_.debounce(function(){T.hoverDrawer.attachScrollBar(t)},500)),a.$scrollInn.on("hitBottom",_.throttle(function(){n.hasClass(f)||(n.addClass(f).data(m,!0),setTimeout(function(){T.drawer.loadMore(t)},500),T.hoverDrawer.relaseAndUnlockDrawer(t))},1e3)),a.$scrollInn.on("hitTop",_.throttle(function(){n.hasClass(p)||n.data(m)||(n.addClass(p).data(m,!0),T.drawer.showLoading(t),T.drawer.getItems(t),T.hoverDrawer.relaseAndUnlockDrawer(t))},250)),n.on("click",".js-track",function(a){var i,n=e(this);n.hasClass("btn-see-all")?i="see_all":n.hasClass("js-view-link")?i="view_"+t:n.hasClass("account-settings")&&(i="notification_settings"),M.track(t,i)}),Fiverr.stopMouseWheel(o)},onHoverDrawerOpen:function(e){var t=T.drawer.get(e);T.drawer.updateAllTimestamps(e),M.view.trimLongText(t),T.hoverDrawer.attachScrollBar(e),M.track(e,"open")},relaseAndUnlockDrawer:function(e){var t=i.hoverDrawer[e],a=t.$hoverDrawer;setTimeout(function(){a.removeClass(f+" "+p),setTimeout(function(){a.data(m,!1)},1e3)},1e3)},destoryScrollBar:function(e){var t=i.hoverDrawer[e],a=t.$scroll;a.data("initialized",null),a.data("antiscroll")&&a.data("antiscroll").destroy()},attachScrollBar:function(e){var t=i.hoverDrawer[e],a=t.$drawer,r=a.outerHeight(),o=t.$scroll,s=o.data("initialized");!s&&r>n.hoverDrawerHeight&&(o.antiscroll(),o.data("initialized",!0))},turnHoverToRedirect:function(e){if(e===s){var t=i.hoverDrawer[e];if(t){var a=t.$hoverDrawer;t.length&&(t.state?T.hoverDrawer.redirectToViewPage(e):a.data("redirect",!0))}}},disableLoadMore:function(e){var a=i.hoverDrawer[e];if(a&&a.length){t.getNotificationCount(e);a.$scrollInn.off("hitBottom")}}},notificationMarkers:{init:function(){Fiverr.models.browser.isMobileResponsive||(i.notificationMarkers={},i.notificationMarkers.$all=i.$mainHeader.find(".js-mark"),i.notificationMarkers.$all.each(function(t,a){var n=e(a),r=n.data("mark");r&&(i.notificationMarkers[r]=n)}),i.notificationMarkers[l]=i.notificationMarkers[s])},toggleMarker:function(e,t){if(!Fiverr.models.browser.isMobileResponsive&&!o){var a=i.notificationMarkers[e],n=a.hasClass("marked")!==t;n&&(a.toggleClass("marked",t),e===l&&t&&(e=s),T.notificationMarkers.toggleLs(e,t))}},toggleLs:function(e,t){var a="header_data_markers",i=ft.utl.getLS(a);i&&(i.markedStatuses[e]=t,ft.utl.setLS(a,i))}}},M={secondsToMs:function(e){return 1e3*e},msToSconds:function(e){return parseInt(e/1e3,10)},isBeforeNow:function(e){var t=Date.now();return t>e},track:function(e,t){if(e&&t){var a={};a[e+"_menu"]=t,Fiverr._reportAuxData(a),Fiverr.pushGoogleUniversalTag("drawers",e,t)}},view:{trimLongText:function(t,a){var i,n="p.text-long:not(.truncated)";i=a&&a.length?t.find('[data-id="'+a.data("id")+'"] p.text-long'):t.find(n),i.each(function(){var t=e(this);t.dotdotdot({wrap:"letter",watch:!1,height:45,ellipsis:'..."',callback:function(e){e?(t.removeClass("text-long"),t.addClass("truncated")):t.parents(".js-hover-drawer").length||t.removeClass("text-long")}})})}}};D.item.prototype={fastForward:function(e){if(e.id){var t=e.updatedAt||M.secondsToMs(e.updated_at),a=e.type===s||e.msg_type===s,i=this.id;if(a)var n=M.secondsToMs(e.recipient_updated_at),r=(e.isOnline||e.is_online,this.isOnline!==e.isOnline);if(i)if(this.updatedAt===t){if(!r)return void(this.state=v);this.state=y}else this.state=b;else this.state=w;a?(this.isSender=t>n,this.recipientUpdatedAt=n,this.snippet=e.preview_text||"",this.username=e.username||null,this.isOnline=e.is_online||!1,this.type=s,this.subType=s):(this.params=e.msg_params,this.type=this.type||e.type||e.msg_type||l,this.subType=e.subType||e.sub_type),this.id=e.id,this.images=e.images||{},this.updatedAt=t||null,this.unreadCount=e.unreadCount||e.unread_count||0,this.isRead=e.isRead||e.is_read,Fiverr._nullOrUndefined(this.isRead)&&(this.isRead=!this.unreadCount),e.url&&(this.url=e.url),i&&store.item.update(this.type,this),onNewItemActions(this)}},toggleRead:function(){var e,t=Date.now();if(!(this.toggleWait&&t<this.toggleWait))return this.toggleWait=t+150,this.isRead?(this.isRead=!1,e=1):(this.isRead=!0,e=-1),this.unreadCount=0,D.postUpdateRead(this.type,this.isRead,this.id),D.incrementTotalUnreadCount(this.type,e),store.item.update(this.type,this),this}},x.store={get:function(e){return a.store.get(e)},set:function(e,t){a.store=a.store.set(e,t)},update:function(e,t){a.store=a.store.update(e,function(){return t})},drawers:{getIn:function(e,t){return store.get(e).getIn(t)},updateIn:function(e,t,a){var i=store.get(e).updateIn(t,function(){return a});store.update(e,i)},merge:function(e,t){var a=store.get(e);a=a.mergeDeep(t),store.update(e,a)}},item:{add:function(e,t,a){var i=store.get(e),n=i.get(C),r=i.get(k),o=t.id;n=n.set(o,t),r=a?r.push(o):r.unshift(o),store.drawers.updateIn(e,[C],n),store.drawers.updateIn(e,[k],r)},getById:function(e,t){var a=store.drawers.getIn(e,[C]);return a.get(t)},update:function(e,t){store.drawers.updateIn(e,[C,t.id],t)}}},onNewItemActions=function(e){var t,a;if(I.data?a=I.data:(I.data=Fiverr.getUserLS("recentInteractions")||[],a=I.data),e.username?t=e.username:e.params&&(t=e.params.seller||e.params.user||e.params.buyer),t){if(a.length){var i=a.indexOf(t);i>-1&&a.splice(i,1)}a.unshift(t),a.length>250&&(a.length=250),clearTimeout(I.timeOut),I.timeOut=setTimeout(function(){Fiverr.setUserLS("recentInteractions",a),Fiverr.setUserLS("interactionsDataDate",Date.now()+2592e5),delete I.data},I.delay)}},t=x,store=t.store,a=D.models,n=t.config,i=T.selectors,window.fNotificationsShared={helpers:M},window.fNotificationDrawer=x,D.init(),r||(T.init(),Fiverr.models.browser.isMobileResponsive||setTimeout(function(){var e=Fiverr.getUserLS("interactionsDataDate");(!e||M.isBeforeNow(e))&&(t.getItems(s),t.getItems(l))},1e3))}(jQuery);